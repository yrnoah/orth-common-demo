import{j as C}from"./jsx-runtime-94f6e698.js";import{r as n}from"./index-8db94870.js";import{p as P}from"./styled-components.browser.esm-655d472d.js";import{P as Y,a as U}from"./Portal-01fdeda0.js";import{u as N}from"./useCurrent-3439251d.js";import{o as D,a as I,i as j,u as X}from"./useMeasure-2fb4c371.js";var H=["mousedown","touchstart"],Z=function(e,r,i){i===void 0&&(i=H);var s=n.useRef(r);n.useEffect(function(){s.current=r},[r]),n.useEffect(function(){for(var t=function(a){var d=e.current;d&&!d.contains(a.target)&&s.current(a)},l=0,f=i;l<f.length;l++){var b=f[l];D(document,b,t)}return function(){for(var a=0,d=i;a<d.length;a++){var u=d[a];I(document,u,t)}}},[i,e])};const G=Z;var J=function(e){n.useEffect(e,[])};const K=J;var Q=function(e){var r=n.useRef(e);r.current=e,K(function(){return function(){return r.current()}})};const ee=Q;var te=function(e){var r=n.useRef(0),i=n.useState(e),s=i[0],t=i[1],l=n.useCallback(function(f){cancelAnimationFrame(r.current),r.current=requestAnimationFrame(function(){t(f)})},[]);return ee(function(){cancelAnimationFrame(r.current)}),[s,l]};const O=te,ne=function(){var e=n.useState(0),r=e[0],i=e[1];return n.useEffect(function(){var s=function(t){i(t.deltaY+r)};return D(window,"wheel",s,!1),function(){return I(window,"wheel",s)}}),r};var re=function(e){var r=O({x:0,y:0}),i=r[0],s=r[1];return n.useEffect(function(){var t=function(){e.current&&s({x:e.current.scrollLeft,y:e.current.scrollTop})};return e.current&&D(e.current,"scroll",t,{capture:!1,passive:!0}),function(){e.current&&I(e.current,"scroll",t)}},[e]),i};const oe=re;var ie=function(){var e=O(function(){return{x:j?window.pageXOffset:0,y:j?window.pageYOffset:0}}),r=e[0],i=e[1];return n.useEffect(function(){var s=function(){i(function(t){var l=window.pageXOffset,f=window.pageYOffset;return t.x!==l||t.y!==f?{x:l,y:f}:t})};return s(),D(window,"scroll",s,{capture:!1,passive:!0}),function(){I(window,"scroll",s)}},[]),r};const le=ie;function se(e=300,r=0,i=40,s=!1,t,l=!1){const f=n.useRef(null),[b,a]=O(0),[d,u]=O(0),[k,M]=n.useState(120),[g,S]=n.useState(i),[p,h]=n.useState(()=>{switch(t){default:return!1;case"top":case"top-left":case"top-right":return!0}}),E=n.useCallback((o,m=300)=>{const q=l?0:g;M(o.width),o.height&&S(o.height);const y=r||o.width,T=window.innerHeight-o.bottom,V=o.left+y-window.innerWidth>0&&y>0;let x=T<m;if((s||t==="bottom"||t==="bottom-left"||t==="bottom-right")&&(x=!1),(t==="top"||t==="top-left"||t==="top-right")&&(x=!0),o.top<m&&(x=!1),o.top!==b&&!x){let v=(o.top||0)+q;l&&v+e>window.innerHeight&&(v=window.innerHeight-e-g),a(v)}if(x&&b!==o.top-m){let v=o.top-m;l&&(v=v+g),a(v)}if(t==="bottom-right"||t==="top-right"){u(o.left-y+o.width);return}if(t==="bottom"||t==="top"){u(o.left-(y-o.width)*.5);return}if(t==="bottom-left"||t==="top-left"){u(o.left||0);return}h(x),V||u(o.left||0),V&&u(o.left-y+o.width)},[r,e,s,t,b,a,g,u,l]),R=n.useCallback(()=>{const o=f.current;o&&o.getBoundingClientRect&&E(o.getBoundingClientRect(),e)},[e,f,E]),w=N(R);return n.useEffect(()=>{w.current()},[w,e,f]),{onHoverUpdateRect:R,updateRect:E,top:Math.max(b,0),isTop:p,left:d,width:k,height:g,ref:f}}function ae(e){if(Array.isArray(e))return!1;switch(typeof e){default:return!1;case"string":case"number":case"bigint":case"boolean":case"undefined":return!1;case"object":case"function":case"symbol":return n.isValidElement(e)}}function L(e){const{overlayContainerStyle:r,visible:i,onVisibleChange:s,disableAnimation:t,disableAutoDismiss:l,parentNodeID:f=U,scrollRef:b,triggerType:a="click",fitToTrigger:d=!1}=e,u=n.useRef(!1),[k,{height:M,width:g}]=X(),S=N(s),[p,h]=n.useState(!!i);n.useEffect(()=>{h(c=>c!==i?!!i:c)},[i]),n.useEffect(()=>{S.current&&S.current(p)},[p,S]);const E=!!M&&!!g,{ref:R,top:w,left:o,onHoverUpdateRect:m,isTop:q}=se(M,g,32,!1,e.position,d);G(R,()=>{l||u.current||h(!1)});const y=ne();n.useEffect(()=>{if(l){m();return}u.current||y&&h(!1)},[y,l,m]);const{x:T,y:V}=le(),x=n.useRef(null),{x:v,y:_}=oe(b||x);n.useEffect(()=>{if(l){m();return}u.current||!T&&!V&&!v&&!_||h(!1)},[l,m,T,V,v,_]);const $=n.useMemo(()=>{const c=E&&p?1:0,z=E&&p?"auto":"none",F=d?1:1.1;let W=p?w:w*(d?1:.9);return q&&(W=p?w:w*F),t&&(W=w),{transition:t?"none":void 0,pointerEvents:z,opacity:c,...r||{},zIndex:p?r==null?void 0:r.zIndex:-1,top:W,left:o}},[E,p,w,q,t,r,o,d]),A=n.useCallback(()=>{u.current=!0,a==="hover"&&h(!0),m()},[m,a]),B=ae(e.children);return C.jsxs(C.Fragment,{children:[B&&n.cloneElement(e.children,{ref:c=>{"ref"in e.children&&typeof e.children.ref=="function"&&e.children.ref(c),"ref"in e.children&&typeof e.children.ref=="object"&&e.children.ref&&"current"in e.children.ref&&(e.children.ref.current=c),R.current=c},onMouseEnter:c=>{e.children.props.onMouseEnter&&e.children.props.onMouseEnter(c),A()},onMouseLeave:c=>{e.children.props.onMouseLeave&&e.children.props.onMouseLeave(c),u.current=!1,a==="hover"&&h(!1)}}),!B&&C.jsx(ue,{ref:R,style:e.style,onMouseEnter:A,onMouseLeave:()=>{u.current=!1,a==="hover"&&h(!1)},role:"select",children:e.children}),!!e.overlay&&C.jsx(Y,{id:f,children:C.jsx(ce,{style:$,ref:c=>c&&k(c),onMouseEnter:A,onMouseLeave:()=>{u.current=!1,a==="hover"&&h(!1)},children:e.overlay})})]})}const ue=P.div`
  position: relative;
  display: flex;
  flex: none;
  width: max-content;
  align-items: center;
  box-sizing: border-box;
`,ce=P.div`
  position: fixed;
  z-index: ${e=>e.theme.zIndexes.dropdownZIndex};
  width: max-content;
  box-sizing: border-box;
  max-height: 80vh;
  transition: top 0.2s ease, opacity 0.2s ease;
`;try{L.displayName="BaseDropdown",L.__docgenInfo={description:"",displayName:"BaseDropdown",props:{children:{defaultValue:null,description:"trigger component",name:"children",required:!1,type:{name:"ReactNode"}},triggerType:{defaultValue:{value:'"click"'},description:"",name:"triggerType",required:!1,type:{name:"enum",value:[{value:'"click"'},{value:'"hover"'}]}},overlay:{defaultValue:null,description:"dropdown component",name:"overlay",required:!1,type:{name:"ReactNode"}},style:{defaultValue:null,description:"trigger wrapper styles",name:"style",required:!1,type:{name:"CSSProperties"}},overlayContainerStyle:{defaultValue:null,description:"dropdown wrapper styles",name:"overlayContainerStyle",required:!1,type:{name:"CSSProperties"}},position:{defaultValue:{value:`undefined = auto
dropdown position: "top-left" | "top-right" | "bottom-left" | "bottom-right" | "top" | "bottom" | undefined = auto`},description:"",name:"position",required:!1,type:{name:"enum",value:[{value:'"auto"'},{value:'"top"'},{value:'"bottom"'},{value:'"top-left"'},{value:'"top-right"'},{value:'"bottom-left"'},{value:'"bottom-right"'}]}},visible:{defaultValue:null,description:"dropdown visible",name:"visible",required:!1,type:{name:"boolean"}},onVisibleChange:{defaultValue:null,description:"dropdown visible onChange callback",name:"onVisibleChange",required:!1,type:{name:"((visible: boolean) => void)"}},disableAutoDismiss:{defaultValue:null,description:"disable the auto dismiss when user click or scroll outside",name:"disableAutoDismiss",required:!1,type:{name:"boolean"}},disableAnimation:{defaultValue:null,description:"disable dropdown enter & leave default animation",name:"disableAnimation",required:!1,type:{name:"boolean"}},parentNodeID:{defaultValue:{value:"dropdownPortalID (`orthogonal-dropdown-overlay`)"},description:"ID of the dom element, which will be insert the dropdown items",name:"parentNodeID",required:!1,type:{name:"string"}},scrollRef:{defaultValue:null,description:"the scroll element ref, add listener to watch scroll event",name:"scrollRef",required:!1,type:{name:"RefObject<HTMLElement>"}},fitToTrigger:{defaultValue:{value:"false"},description:"@description when set to true, overlay position should cover trigger",name:"fitToTrigger",required:!1,type:{name:"boolean"}}}}}catch{}export{L as B};
//# sourceMappingURL=Dropdown-017f14c9.js.map
