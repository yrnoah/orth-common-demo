import{r,j as M,d as B}from"./iframe-AucjWJ36.js";import{a as G,P as J}from"./Portal-Cf1ZhHdQ.js";import{u as X}from"./useCurrent-Bts7HZnN.js";import{o as O,a as A,i as Z,u as K}from"./useMeasure-DDH6vtW2.js";var Q=["mousedown","touchstart"],ee=function(e,o,i){i===void 0&&(i=Q);var a=r.useRef(o);r.useEffect(function(){a.current=o},[o]),r.useEffect(function(){for(var t=function(l){var m=e.current;m&&!m.contains(l.target)&&a.current(l)},s=0,u=i;s<u.length;s++){var R=u[s];O(document,R,t)}return function(){for(var l=0,m=i;l<m.length;l++){var c=m[l];A(document,c,t)}}},[i,e])},te=function(e){r.useEffect(e,[])},ne=function(e){var o=r.useRef(e);o.current=e,te(function(){return function(){return o.current()}})},L=function(e){var o=r.useRef(0),i=r.useState(e),a=i[0],t=i[1],s=r.useCallback(function(u){cancelAnimationFrame(o.current),o.current=requestAnimationFrame(function(){t(u)})},[]);return ne(function(){cancelAnimationFrame(o.current)}),[a,s]};const re=(function(){var e=r.useState(0),o=e[0],i=e[1];return r.useEffect(function(){var a=function(t){i(t.deltaY+o)};return O(window,"wheel",a,!1),function(){return A(window,"wheel",a)}}),o});var oe=function(e){var o=L({x:0,y:0}),i=o[0],a=o[1];return r.useEffect(function(){var t=function(){e.current&&a({x:e.current.scrollLeft,y:e.current.scrollTop})};return e.current&&O(e.current,"scroll",t,{capture:!1,passive:!0}),function(){e.current&&A(e.current,"scroll",t)}},[e]),i},ie=function(){var e=L(function(){return{x:Z?window.pageXOffset:0,y:Z?window.pageYOffset:0}}),o=e[0],i=e[1];return r.useEffect(function(){var a=function(){i(function(t){var s=window.pageXOffset,u=window.pageYOffset;return t.x!==s||t.y!==u?{x:s,y:u}:t})};return a(),O(window,"scroll",a,{capture:!1,passive:!0}),function(){A(window,"scroll",a)}},[]),o};function le(e=300,o=0,i=40,a=!1,t,s=!1){const u=r.useRef(null),[R,l]=L(0),[m,c]=L(0),[v,D]=r.useState(120),[d,E]=r.useState(i),[C,w]=r.useState(()=>{switch(t){default:return!1;case"top":case"top-left":case"top-right":return!0}}),[p,q]=r.useState(()=>{switch(t){case"left-top":case"left":case"left-bottom":case"right-top":case"right":case"right-bottom":return"horizontal";default:return"vertical"}}),T=r.useCallback((n,b=300)=>{const z=s?0:d;D(n.width),n.height&&E(n.height);const h=o||n.width,I=window.innerHeight-n.bottom,W=n.left+h-window.innerWidth>0&&h>0;let x=I<b;if((a||t==="bottom"||t==="bottom-left"||t==="bottom-right")&&(x=!1),(t==="top"||t==="top-left"||t==="top-right")&&(x=!0),n.top<b&&(x=!1),n.top!==R&&!x){let g=(n.top||0)+z;s&&g+e>window.innerHeight&&(g=window.innerHeight-e-d),l(g)}if(x&&R!==n.top-b){let g=n.top-b;s&&(g=g+d),l(g)}if(t?.startsWith("left-")||t==="left"||t?.startsWith("right-")||t==="right"){const g=t?.startsWith("right");c(g?n.left+n.width:Math.max(0,n.left-h)),t?.endsWith("-top")?l(n.top):t?.endsWith("-bottom")?l(Math.max(0,n.top+n.height-b)):l(Math.max(0,n.top+(n.height-b)/2)),q("horizontal");return}if(t==="bottom-right"||t==="top-right"){c(n.left-h+n.width);return}if(t==="bottom"||t==="top"){c(n.left-(h-n.width)*.5);return}if(t==="bottom-left"||t==="top-left"){c(n.left||0);return}w(x),W||c(n.left||0),W&&c(n.left-h+n.width)},[o,e,a,t,R,l,d,c,s]),y=r.useCallback(()=>{const n=u.current;n&&n.getBoundingClientRect&&T(n.getBoundingClientRect(),e)},[e,u,T]),S=X(y);return r.useEffect(()=>{S.current()},[S,e,u]),{onHoverUpdateRect:y,updateRect:T,top:Math.max(R,0),isTop:C,left:Math.max(m,0),width:v,height:d,ref:u,triggerRect:u.current?.getBoundingClientRect(),placement:p}}function se(e){if(Array.isArray(e))return!1;switch(typeof e){default:return!1;case"string":case"number":case"bigint":case"boolean":case"undefined":return!1;case"object":case"function":case"symbol":return r.isValidElement(e)}}function ae(e){const{overlayContainerStyle:o,visible:i,onVisibleChange:a,disableAnimation:t,disableAutoDismiss:s,parentNodeID:u=G,scrollRef:R,triggerType:l="click",fitToTrigger:m=!1,hoverZonePadding:c=10}=e,v=r.useRef(!1),[D,{height:d,width:E}]=K(),C=X(a),[w,p]=r.useState(!!i);r.useEffect(()=>{p(f=>f!==i?!!i:f)},[i]),r.useEffect(()=>{C.current&&C.current(w)},[w,C]);const q=!!d&&!!E,{ref:T,top:y,left:S,onHoverUpdateRect:n,isTop:b,placement:z,triggerRect:h}=le(d,E,32,!1,e.position,m);ee(T,()=>{s||v.current||p(!1)});const I=re();r.useEffect(()=>{if(s){n();return}v.current||I&&p(!1)},[I,s,n]);const{x:W,y:x}=ie(),g=r.useRef(null),{x:V,y:_}=oe(R||g);r.useEffect(()=>{if(s){n();return}v.current||!W&&!x&&!V&&!_||p(!1)},[s,n,W,x,V,_]);const N=r.useMemo(()=>{const f=q&&w?1:0,U=q&&w?"auto":"none",k=m?1:.1;let j=y,H=S,F="50vh";const Y=window.innerHeight??document.body.clientHeight;return d&&Y&&(b||(F=`${Math.max(Y-y-8,200)}px`)),!t&&!w&&(z==="horizontal"?e.position?.startsWith("right")?H=S-k*E:H=S+k*E:b?j=y+k*d:j=y-k*d),t&&(j=y,H=S),{transition:t?"none":void 0,pointerEvents:U,opacity:f,...o||{},zIndex:w?o?.zIndex:-1,top:j,left:H,maxHeight:F}},[q,w,y,b,t,o,S,m,z,e.position,d,E]),P=r.useCallback(()=>{v.current=!0,l==="hover"&&p(!0),n()},[n,l]),$=se(e.children);return M.jsxs(M.Fragment,{children:[$&&r.cloneElement(e.children,{ref:f=>{"ref"in e.children&&typeof e.children.ref=="function"&&e.children.ref(f),"ref"in e.children&&typeof e.children.ref=="object"&&e.children.ref&&"current"in e.children.ref&&(e.children.ref.current=f),T.current=f},onMouseEnter:f=>{e.children.props.onMouseEnter&&e.children.props.onMouseEnter(f),P()},onMouseLeave:f=>{e.children.props.onMouseLeave&&e.children.props.onMouseLeave(f),v.current=!1,l==="hover"&&p(!1)}}),!$&&M.jsx(ce,{ref:T,style:e.style,onMouseEnter:P,onMouseLeave:()=>{v.current=!1,l==="hover"&&p(!1)},role:"select",children:e.children}),!!e.overlay&&M.jsxs(J,{id:u,children:[e.overlaySiblings,c>0&&w&&l==="hover"&&!!h?.width&&M.jsx(fe,{style:{zIndex:N.zIndex||void 0,width:h.width+c*2,height:h.height+c*2,top:h.top-c,left:h.left-c},onMouseEnter:P,onMouseLeave:()=>{v.current=!1,p(!1)}}),M.jsx(ue,{style:N,ref:f=>{f&&D(f)},onMouseEnter:P,onMouseLeave:()=>{v.current=!1,l==="hover"&&p(!1)},$maxHeight:N.maxHeight,children:e.overlay})]})]})}const ce=B.div`
  position: relative;
  display: flex;
  flex: none;
  width: max-content;
  align-items: center;
  box-sizing: border-box;
`,ue=B.div`
  position: fixed;
  z-index: ${e=>e.theme.zIndexes.dropdownZIndex};
  width: max-content;
  box-sizing: border-box;
  max-height: 80vh;
  transition: top 0.2s ease, left 0.2s ease, opacity 0.2s ease;

  && > * {
    max-height: ${e=>e.$maxHeight??"80vh"};
  }
`,fe=B.div`
  position: fixed;
  z-index: ${e=>e.theme.zIndexes.dropdownZIndex};
`;ae.__docgenInfo={description:"",methods:[],displayName:"BaseDropdown",props:{children:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"trigger component"},triggerType:{required:!1,tsType:{name:"union",raw:'"click" | "hover"',elements:[{name:"literal",value:'"click"'},{name:"literal",value:'"hover"'}]},description:'@default "click"'},overlay:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"dropdown component"},overlaySiblings:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"@description will put upon overlay"},hoverZonePadding:{required:!1,tsType:{name:"number"},description:`@default 10px
@description when triggerType = hover, set hover zone to cover trigger to make the overlay easy to display`},style:{required:!1,tsType:{name:"ReactCSSProperties",raw:"React.CSSProperties"},description:"trigger wrapper styles"},overlayContainerStyle:{required:!1,tsType:{name:"ReactCSSProperties",raw:"React.CSSProperties"},description:"dropdown wrapper styles"},position:{required:!1,tsType:{name:"union",raw:`| "top-left"
| "top-right"
| "bottom-left"
| "bottom-right"
| "top"
| "bottom"
| "left-top"
| "left"
| "left-bottom"
| "right-top"
| "right"
| "right-bottom"
| "auto"
| undefined`,elements:[{name:"literal",value:'"top-left"'},{name:"literal",value:'"top-right"'},{name:"literal",value:'"bottom-left"'},{name:"literal",value:'"bottom-right"'},{name:"literal",value:'"top"'},{name:"literal",value:'"bottom"'},{name:"literal",value:'"left-top"'},{name:"literal",value:'"left"'},{name:"literal",value:'"left-bottom"'},{name:"literal",value:'"right-top"'},{name:"literal",value:'"right"'},{name:"literal",value:'"right-bottom"'},{name:"literal",value:'"auto"'},{name:"undefined"}]},description:`@default undefined = auto
dropdown position:
- Vertical positions: "top-left" | "top" | "top-right" | "bottom-left" | "bottom" | "bottom-right"
- Horizontal positions: "left-top" | "left" | "left-bottom" | "right-top" | "right" | "right-bottom"
- Auto: "auto" | undefined`},visible:{required:!1,tsType:{name:"boolean"},description:"dropdown visible"},onVisibleChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(visible: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"visible"}],return:{name:"void"}}},description:"dropdown visible onChange callback"},disableAutoDismiss:{required:!1,tsType:{name:"boolean"},description:"disable the auto dismiss when user click or scroll outside"},disableAnimation:{required:!1,tsType:{name:"boolean"},description:"disable dropdown enter & leave default animation"},parentNodeID:{required:!1,tsType:{name:"string"},description:"ID of the dom element, which will be insert the dropdown items\n@default dropdownPortalID (`orthogonal-dropdown-overlay`)"},scrollRef:{required:!1,tsType:{name:"ReactRefObject",raw:"React.RefObject<HTMLElement | null>",elements:[{name:"union",raw:"HTMLElement | null",elements:[{name:"HTMLElement"},{name:"null"}]}]},description:"the scroll element ref, add listener to watch scroll event"},fitToTrigger:{required:!1,tsType:{name:"boolean"},description:`@default false
@description when set to true, overlay position should cover trigger`}}};export{ae as B};
