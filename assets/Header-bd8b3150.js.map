{"version":3,"file":"Header-bd8b3150.js","sources":["../../../paas-library/src/Header/styles.ts","../../../paas-library/src/Header/useSliderAnim.ts","../../../paas-library/src/Header/Header.tsx"],"sourcesContent":["import { animated } from \"@react-spring/web\";\nimport styled from \"styled-components\";\n\nexport const Header = styled.div((p) => ({\n  width: \"100%\",\n  height: 48,\n  position: \"sticky\",\n  top: 0,\n  left: 0,\n  boxSizing: \"border-box\",\n  backgroundColor: \"white\",\n\n  color: p.theme.colors.header.inavtive,\n  transition: \"color 0.2s\",\n\n  ...p.theme.fontStyleDict.header,\n\n  display: \"flex\",\n  alignItems: \"center\",\n  padding: \"0 10%\",\n  zIndex: p.theme.zIndexes.navbar,\n}));\nexport const HeaderMenuWrapper = styled.div({\n  display: \"flex\",\n  userSelect: \"none\",\n});\n\nexport const Slider = styled(animated.div)((p) => ({\n  width: 0,\n  height: 6.4,\n  backgroundColor: p.theme.colors.primaryLight,\n  borderRadius: 5,\n  position: \"static\",\n  zIndex: p.theme.zIndexes.navbar + 1,\n  marginTop: 8,\n  flexShrink: 0,\n}));\nexport const SLIDER_WIDTH_OFFSET = 5;\n\nexport const AnimatedDiv = styled(animated.div)((p) => ({\n  marginRight: 40,\n  cursor: \"pointer\",\n  zIndex: p.theme.zIndexes.navbar + 2,\n}));\n\nexport const PaasTerm = styled.a({\n  color: \"unset\",\n  textDecoration: \"none\",\n});\n","import { useSpring } from \"@react-spring/web\";\nimport React from \"react\";\nimport { SLIDER_WIDTH_OFFSET } from \"./styles\";\n\nexport function useSliderAnimation(\n  hoverIndex: number,\n  currentIndex: number,\n  children: React.ReactNode[],\n  childrenContainer: React.RefObject<HTMLDivElement>,\n  headerContainer: React.RefObject<HTMLDivElement>\n) {\n  const [anim, api] = useSpring(() => ({}));\n  const xPositions = React.useMemo(\n    () => new Array(children.length).fill(0),\n    [children]\n  );\n  const widths = React.useMemo(\n    () => new Array(children.length).fill(0),\n    [children]\n  );\n  const [menuWidth, setMenuWidth] = React.useState(0);\n  const handler = React.useCallback(\n    (resize: ResizeObserverEntry[]) => {\n      if (childrenContainer.current) {\n        const length = childrenContainer.current.children.length;\n        const activeIndex =\n          hoverIndex === -1\n            ? currentIndex\n            : Math.min(Math.max(hoverIndex, 0), length - 1); // normalize index\n        const activeChild = childrenContainer.current.children[activeIndex];\n        const [xNext, wNext] = getAnchor(activeChild);\n        if (\n          // has update\n          xPositions[activeIndex] !== xNext ||\n          widths[activeIndex] !== wNext\n        ) {\n          // update current index\n          xPositions[activeIndex] = xNext;\n          widths[activeIndex] = wNext;\n        }\n        // initialize pivot\n        if (xPositions[0] === 0) {\n          const first = childrenContainer.current.children[0];\n          xPositions[0] = first.getBoundingClientRect().x;\n          widths[0] = first.getBoundingClientRect().width;\n        }\n        const menuWidthNext =\n          childrenContainer.current.getBoundingClientRect().width;\n        // while window resized\n        if (menuWidthNext !== menuWidth) {\n          setMenuWidth(menuWidthNext);\n          const [pivotX, pivotWidth] = getAnchor(\n            childrenContainer.current.children[0]\n          );\n          xPositions[0] = pivotX;\n          widths[0] = pivotWidth;\n        }\n\n        const x = xNext - xPositions[0] - SLIDER_WIDTH_OFFSET - menuWidthNext;\n        const width = wNext + SLIDER_WIDTH_OFFSET * 2;\n        api.start({ to: { x, width } });\n      }\n    },\n    [\n      childrenContainer,\n      hoverIndex,\n      currentIndex,\n      menuWidth,\n      xPositions,\n      api,\n      widths,\n    ]\n  );\n  // get anchor from refs\n  React.useEffect(() => {\n    if (headerContainer.current) {\n      const observer = new ResizeObserver(handler);\n      const container = headerContainer.current;\n      observer.observe(container);\n      return () => {\n        observer.unobserve(container);\n      };\n    }\n  }, [children, childrenContainer, headerContainer, handler]);\n  return anim;\n}\n\nconst getAnchor = (element: Element) => [\n  element.getBoundingClientRect().x,\n  element.getBoundingClientRect().width,\n];\n","import { useSprings } from \"@react-spring/web\";\nimport React from \"react\";\nimport { useTheme } from \"styled-components\";\nimport * as S from \"./styles\";\n\nimport type { IHeader } from \"./header.d\";\nimport { useSliderAnimation } from \"./useSliderAnim\";\n\nexport function Header({ children, currentTermIndex: cur }: IHeader) {\n  const { colors } = useTheme();\n  const ref = React.useRef<HTMLDivElement>(null);\n  const headerContainerRef = React.useRef<HTMLDivElement>(null);\n  const [hover, setHover] = React.useState(-1);\n  const [active, api] = useSprings(\n    children.length,\n    (index) => ({\n      color: index === cur ? colors.primary : colors.header.inavtive,\n    }),\n    []\n  );\n  // change animation on hover\n  const onHover = (index: number) => {\n    if (ref.current) {\n      setHover(index);\n      api.start((i) => ({\n        color: i === index ? colors.primary : colors.header.inavtive,\n      }));\n    }\n  };\n  const onLeave = () => {\n    setHover(-1);\n    api.start((index) => ({\n      color: index === cur ? colors.primary : colors.header.inavtive,\n    }));\n  };\n\n  // animation update\n  const sliderAnim = useSliderAnimation(\n    hover,\n    cur,\n    children,\n    ref,\n    headerContainerRef\n  );\n\n  return (\n    <S.Header onMouseLeave={onLeave} ref={headerContainerRef}>\n      <S.HeaderMenuWrapper ref={ref}>\n        {children.map((term, index) => (\n          <S.AnimatedDiv\n            key={index}\n            style={active[index]}\n            onMouseEnter={() => onHover(index)}\n          >\n            {term}\n          </S.AnimatedDiv>\n        ))}\n      </S.HeaderMenuWrapper>\n      <S.Slider style={sliderAnim} />\n    </S.Header>\n  );\n}\n"],"names":["Header","styled","div","p","width","height","position","top","left","boxSizing","backgroundColor","color","theme","colors","header","inavtive","transition","fontStyleDict","display","alignItems","padding","zIndex","zIndexes","navbar","HeaderMenuWrapper","userSelect","Slider","animated","primaryLight","borderRadius","marginTop","flexShrink","SLIDER_WIDTH_OFFSET","AnimatedDiv","marginRight","cursor","PaasTerm","a","textDecoration","useSliderAnimation","hoverIndex","currentIndex","children","childrenContainer","headerContainer","anim","api","useSpring","xPositions","React","useMemo","Array","length","fill","widths","menuWidth","setMenuWidth","useState","handler","useCallback","resize","current","activeIndex","Math","min","max","activeChild","xNext","wNext","getAnchor","first","getBoundingClientRect","x","menuWidthNext","pivotX","pivotWidth","start","to","useEffect","observer","ResizeObserver","container","observe","unobserve","element","ref","headerContainerRef","hover","setHover","active","useSprings","index","cur","onHover","i","onLeave","sliderAnim","jsxs","S.Header","jsx","S.HeaderMenuWrapper","term","S.AnimatedDiv","S.Slider"],"mappings":"kOAGaA,MAAAA,EAASC,EAAOC,IAAYC,IAAA,CACvCC,MAAO,OACPC,OAAQ,GACRC,SAAU,SACVC,IAAK,EACLC,KAAM,EACNC,UAAW,aACXC,gBAAiB,QAEjBC,MAAOR,EAAES,MAAMC,OAAOC,OAAOC,SAC7BC,WAAY,aAEZ,GAAGb,EAAES,MAAMK,cAAcH,OAEzBI,QAAS,OACTC,WAAY,SACZC,QAAS,QACTC,OAAQlB,EAAES,MAAMU,SAASC,MAC3B,EAAE,EACWC,EAAoBvB,EAAOC,IAAI,CAC1CgB,QAAS,OACTO,WAAY,MACd,CAAC,EAEYC,EAASzB,EAAO0B,EAASzB,GAAG,EAAUC,IAAA,CACjDC,MAAO,EACPC,OAAQ,IACRK,gBAAiBP,EAAES,MAAMC,OAAOe,aAChCC,aAAc,EACdvB,SAAU,SACVe,OAAQlB,EAAES,MAAMU,SAASC,OAAS,EAClCO,UAAW,EACXC,WAAY,CACd,EAAE,EACWC,EAAsB,EAEtBC,EAAchC,EAAO0B,EAASzB,GAAG,EAAUC,IAAA,CACtD+B,YAAa,GACbC,OAAQ,UACRd,OAAQlB,EAAES,MAAMU,SAASC,OAAS,CACpC,EAAE,EAEWa,EAAWnC,EAAOoC,EAAE,CAC/B1B,MAAO,QACP2B,eAAgB,MAClB,CAAC,EC5CM,SAASC,EACdC,EACAC,EACAC,EACAC,EACAC,EACA,CACA,KAAM,CAACC,EAAMC,CAAG,EAAIC,EAAU,KAAO,CAAG,EAAA,EAClCC,EAAaC,EAAMC,QACvB,IAAM,IAAIC,MAAMT,EAASU,MAAM,EAAEC,KAAK,CAAC,EACvC,CAACX,CAAQ,CACX,EACMY,EAASL,EAAMC,QACnB,IAAM,IAAIC,MAAMT,EAASU,MAAM,EAAEC,KAAK,CAAC,EACvC,CAACX,CAAQ,CACX,EACM,CAACa,EAAWC,CAAY,EAAIP,EAAMQ,SAAS,CAAC,EAC5CC,EAAUT,EAAMU,YACnBC,GAAkC,CACjC,GAAIjB,EAAkBkB,QAAS,CACvBT,MAAAA,EAAST,EAAkBkB,QAAQnB,SAASU,OAC5CU,EACJtB,IAAe,GACXC,EACAsB,KAAKC,IAAID,KAAKE,IAAIzB,EAAY,CAAC,EAAGY,EAAS,CAAC,EAC5Cc,EAAcvB,EAAkBkB,QAAQnB,SAASoB,CAAW,EAC5D,CAACK,EAAOC,CAAK,EAAIC,EAAUH,CAAW,EAWxClB,IARFA,EAAWc,CAAW,IAAMK,GAC5Bb,EAAOQ,CAAW,IAAMM,KAGxBpB,EAAWc,CAAW,EAAIK,EAC1Bb,EAAOQ,CAAW,EAAIM,GAGpBpB,EAAW,CAAC,IAAM,EAAG,CACvB,MAAMsB,EAAQ3B,EAAkBkB,QAAQnB,SAAS,CAAC,EAClDM,EAAW,CAAC,EAAIsB,EAAMC,sBAAAA,EAAwBC,EAC9ClB,EAAO,CAAC,EAAIgB,EAAMC,sBAAAA,EAAwBnE,MAE5C,MAAMqE,EACJ9B,EAAkBkB,QAAQU,sBAAAA,EAAwBnE,MAEpD,GAAIqE,IAAkBlB,EAAW,CAC/BC,EAAaiB,CAAa,EACpB,KAAA,CAACC,EAAQC,CAAU,EAAIN,EAC3B1B,EAAkBkB,QAAQnB,SAAS,CAAC,CACtC,EACAM,EAAW,CAAC,EAAI0B,EAChBpB,EAAO,CAAC,EAAIqB,EAGd,MAAMH,EAAIL,EAAQnB,EAAW,CAAC,EAAIhB,EAAsByC,EAClDrE,EAAQgE,EAAQpC,EAAsB,EAC5Cc,EAAI8B,MAAM,CAAEC,GAAI,CAAEL,EAAAA,EAAGpE,MAAAA,CAAM,CAAA,CAAG,EAChC,EAEF,CACEuC,EACAH,EACAC,EACAc,EACAP,EACAF,EACAQ,CAAM,CAEV,EAEAL,OAAAA,EAAM6B,UAAU,IAAM,CACpB,GAAIlC,EAAgBiB,QAAS,CACrBkB,MAAAA,EAAW,IAAIC,eAAetB,CAAO,EACrCuB,EAAYrC,EAAgBiB,QAClCkB,OAAAA,EAASG,QAAQD,CAAS,EACnB,IAAM,CACXF,EAASI,UAAUF,CAAS,CAAA,IAG/B,CAACvC,EAAUC,EAAmBC,EAAiBc,CAAO,CAAC,EACnDb,CACT,CAEA,MAAMwB,EAAae,GAAqB,CACtCA,EAAQb,wBAAwBC,EAChCY,EAAQb,sBAAsB,EAAEnE,KAAK,ECjFhC,SAAAJ,EAAA,CAAgB,SAAA0C,EAAEA,iBAAAA,CAAyC,EAAA,CAChE,KAAA,CAAM,OAAA7B,CAAEA,EAAAA,EAAAA,EACRwE,EAAApC,EAAA,OAAA,IAAA,EACAqC,EAAArC,EAAA,OAAA,IAAA,EACA,CAAAsC,EAAAC,CAAA,EAAAvC,EAAA,SAAA,EAAA,EACA,CAAAwC,EAAA3C,CAAA,EAAA4C,EAAAhD,EAAA,OAAAiD,IAAA,CAEc,MAAAA,IAAAC,EAAA/E,EAAA,QAAAA,EAAA,OAAA,QAC4CE,GAAAA,CAAAA,CAAAA,EAK1D8E,EAAAF,GAAA,CACEN,EAAA,UACEG,EAAAA,CAAAA,EACA1C,EAAAA,MAAAA,IAAAA,CAAkB,MAAAgD,IAAAH,EAAA9E,EAAA,QAAAA,EAAA,OAAA,QACoCE,EAAAA,EAExD,EAEFgF,EAAA,IAAA,CACEP,EAAAA,EAAAA,EACA1C,EAAAA,MAAAA,IAAAA,CAAsB,MAAA6C,IAAAC,EAAA/E,EAAA,QAAAA,EAAA,OAAA,QACkCE,EAAAA,CACtD,EAIJiF,EAAAzD,EAAAgD,EAAAK,EAAAlD,EAAA2C,EAAAC,CAAA,EAQA,OAAAW,EAAAA,KAAAC,EAAA,CAAA,aAAAH,EAAA,IAAAT,EAAA,SAAA,CAEIa,EAAAA,IAAAC,EAAA,CAAA,IAAAf,EAAA,SAAA3C,EAAA,IAAA,CAAA2D,EAAAV,IAAAQ,EAAAA,IAAAG,EAAA,CAAA,MAAAb,EAAAE,CAAA,EAAA,aAAA,IAAAE,EAAAF,CAAA,EAAA,SAAAU,CAAA,EAAAV,CAAA,CAAA,CAAA,CAAA,EAUAQ,EAAAA,IAAAI,EAAA,CAAA,MAAAP,CAAA,CAAA,CAC4B,CAAA,CAAA,CAGlC"}