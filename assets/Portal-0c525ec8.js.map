{"version":3,"file":"Portal-0c525ec8.js","sources":["../../../paas-library/src/Siblings/portalID.ts","../../../paas-library/src/Siblings/useCreatePortal.ts","../../../paas-library/src/Siblings/Portal.tsx"],"sourcesContent":["export const rootPortalID = \"dom-portals\";\nexport const drawerPortalID = \"orthogonal-drawer\";\nexport const dropdownPortalID = \"orthogonal-dropdown-overlay\";\nexport const modalPortalID = \"orthogonal-modals\";\nexport const tabTooltipPortalID = \"orthogonal-tab-tooltips\";\n","import { useRef, useEffect } from \"react\";\nimport { rootPortalID } from \"./portalID\";\n\nexport const rootID = rootPortalID;\n\nfunction createRootElement(id: string) {\n  const rootContainer = document.createElement(\"div\");\n  rootContainer.setAttribute(\"id\", id);\n  rootContainer.setAttribute(\"data-id\", id);\n  return rootContainer;\n}\n\nfunction addRootElement(rootElem: Node) {\n  document.body.insertBefore(\n    rootElem,\n    document.body.lastElementChild!.nextElementSibling\n  );\n}\n\nfunction usePortal(id: string = rootID) {\n  const rootElemRef = useRef<HTMLDivElement | null>(null);\n\n  useEffect(\n    function setupElement() {\n      const rootEL = rootElemRef.current;\n      if (!rootEL) return;\n      if (!id) return;\n      // Look for existing target dom element to append to\n      const existingParent =\n        document.querySelector(`#${id}`) ||\n        document.querySelector(`[data-id=\"${id}\"]`);\n      // Parent is either a new root or the existing dom element\n      const parentElem = existingParent || createRootElement(id);\n\n      // If there is no existing DOM element, add a new one.\n      if (!existingParent) addRootElement(parentElem);\n\n      // Add the detached element to the parent\n      parentElem.appendChild(rootEL);\n\n      return function removeElement() {\n        rootEL.remove();\n        if (!parentElem.childElementCount) {\n          parentElem.remove();\n        }\n      };\n    },\n    [id]\n  );\n\n  /**\n   * It's important we evaluate this lazily:\n   * - We need first render to contain the DOM element, so it shouldn't happen\n   *   in useEffect. We would normally put this in the constructor().\n   * - We can't do 'const rootElemRef = useRef(document.createElement('div))',\n   *   since this will run every single render (that's a lot).\n   * - We want the ref to consistently point to the same DOM element and only\n   *   ever run once.\n   * @link https://reactjs.org/docs/hooks-faq.html#how-to-create-expensive-objects-lazily\n   */\n  function getRootElem() {\n    if (!rootElemRef.current) {\n      rootElemRef.current = document.createElement(\"div\");\n    }\n    return rootElemRef.current;\n  }\n\n  return getRootElem();\n}\n\nexport default usePortal;\n","import React from \"react\";\nimport { createPortal } from \"react-dom\";\nimport usePortal, { rootID } from \"./useCreatePortal\";\n\n/**\n * @example\n * <Portal id=\"modal\">\n *   <p>Thinking with portals</p>\n * </Portal>\n */\nexport function Portal({\n  id = rootID,\n  children,\n}: React.PropsWithChildren<{ id?: string }>) {\n  const target = usePortal(id);\n  return createPortal(children, target);\n}\n\nexport default Portal;\n"],"names":["rootPortalID","drawerPortalID","dropdownPortalID","rootID","createRootElement","id","rootContainer","document","createElement","setAttribute","addRootElement","rootElem","body","insertBefore","lastElementChild","nextElementSibling","usePortal","rootElemRef","useRef","useEffect","rootEL","current","existingParent","querySelector","parentElem","appendChild","remove","childElementCount","getRootElem","Portal","target","createPortal","children"],"mappings":"gFAAO,MAAMA,EAAe,cACfC,EAAiB,oBACjBC,EAAmB,8BCCnBC,EAASH,EAEtB,SAASI,EAAkBC,EAAY,CAC/BC,MAAAA,EAAgBC,SAASC,cAAc,KAAK,EACpCC,OAAAA,EAAAA,aAAa,KAAMJ,CAAE,EACrBI,EAAAA,aAAa,UAAWJ,CAAE,EACjCC,CACT,CAEA,SAASI,EAAeC,EAAgB,CACtCJ,SAASK,KAAKC,aACZF,EACAJ,SAASK,KAAKE,iBAAkBC,kBAClC,CACF,CAEA,SAASC,EAAUX,EAAaF,EAAQ,CAChCc,MAAAA,EAAcC,SAA8B,IAAI,EAEtDC,EAAAA,UACE,UAAwB,CACtB,MAAMC,EAASH,EAAYI,QAE3B,GADI,CAACD,GACD,CAACf,EAAI,OAEHiB,MAAAA,EACJf,SAASgB,cAAe,IAAGlB,GAAI,GAC/BE,SAASgB,cAAe,aAAYlB,KAAM,EAEtCmB,EAAaF,GAAkBlB,EAAkBC,CAAE,EAGzD,OAAKiB,GAAgBZ,EAAec,CAAU,EAG9CA,EAAWC,YAAYL,CAAM,EAEtB,UAAyB,CAC9BA,EAAOM,OAAO,EACTF,EAAWG,mBACdH,EAAWE,OAAO,CACpB,CACF,EAEF,CAACrB,CAAE,CACL,EAYA,SAASuB,GAAc,CACjB,OAACX,EAAYI,UACHA,EAAAA,QAAUd,SAASC,cAAc,KAAK,GAE7CS,EAAYI,OACrB,CAEA,OAAOO,EAAY,CACrB,CC1DO,SAAAC,EAAA,CAAgB,GAAAxB,EAAAF,EAChBA,SAAAA,CAEmC,EAAA,CACxC,MAAA2B,EAAAd,EAAAX,CAAA,EACA,OAAA0B,EAAA,aAAAC,EAAAF,CAAA,CACF"}