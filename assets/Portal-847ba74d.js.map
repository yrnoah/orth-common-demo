{"version":3,"file":"Portal-847ba74d.js","sources":["../../../paas-library/src/Siblings/portalID.ts","../../../paas-library/src/Siblings/useCreatePortal.ts","../../../paas-library/src/Siblings/Portal.tsx"],"sourcesContent":["export const rootPortalID = \"dom-portals\";\nexport const drawerPortalID = \"orthogonal-drawer\";\nexport const dropdownPortalID = \"orthogonal-dropdown-overlay\";\nexport const modalPortalID = \"orthogonal-modals\";\nexport const tabTooltipPortalID = \"orthogonal-tab-tooltips\";\n","import { useRef, useEffect } from \"react\";\nimport { rootPortalID } from \"./portalID\";\n\nexport const rootID = rootPortalID;\n\nfunction createRootElement(id: string) {\n  const rootContainer = document.createElement(\"div\");\n  rootContainer.setAttribute(\"id\", id);\n  rootContainer.setAttribute(\"data-id\", id);\n  return rootContainer;\n}\n\nfunction addRootElement(rootElem: Node) {\n  document.body.insertBefore(\n    rootElem,\n    document.body.lastElementChild!.nextElementSibling\n  );\n}\n\nfunction usePortal(id: string = rootID) {\n  const rootElemRef = useRef<HTMLDivElement | null>(null);\n\n  useEffect(\n    function setupElement() {\n      const rootEL = rootElemRef.current;\n      if (!rootEL) return;\n      if (!id) return;\n      // Look for existing target dom element to append to\n      const existingParent =\n        document.querySelector(`#${id}`) ||\n        document.querySelector(`[data-id=\"${id}\"]`);\n      // Parent is either a new root or the existing dom element\n      const parentElem = existingParent || createRootElement(id);\n\n      // If there is no existing DOM element, add a new one.\n      if (!existingParent) addRootElement(parentElem);\n\n      // Add the detached element to the parent\n      parentElem.appendChild(rootEL);\n\n      return function removeElement() {\n        rootEL.remove();\n        if (!parentElem.childElementCount) {\n          parentElem.remove();\n        }\n      };\n    },\n    [id]\n  );\n\n  /**\n   * It's important we evaluate this lazily:\n   * - We need first render to contain the DOM element, so it shouldn't happen\n   *   in useEffect. We would normally put this in the constructor().\n   * - We can't do 'const rootElemRef = useRef(document.createElement('div))',\n   *   since this will run every single render (that's a lot).\n   * - We want the ref to consistently point to the same DOM element and only\n   *   ever run once.\n   * @link https://reactjs.org/docs/hooks-faq.html#how-to-create-expensive-objects-lazily\n   */\n  function getRootElem() {\n    if (!rootElemRef.current) {\n      rootElemRef.current = document.createElement(\"div\");\n    }\n    return rootElemRef.current;\n  }\n\n  return getRootElem();\n}\n\nexport default usePortal;\n","import React from \"react\";\nimport { createPortal } from \"react-dom\";\nimport usePortal, { rootID } from \"./useCreatePortal\";\n\n/**\n * @example\n * <Portal id=\"modal\">\n *   <p>Thinking with portals</p>\n * </Portal>\n */\nexport function Portal({\n  id = rootID,\n  children,\n}: React.PropsWithChildren<{ id?: string }>) {\n  const target = usePortal(id);\n  return createPortal(children, target);\n}\n\nexport default Portal;\n"],"names":["rootPortalID","drawerPortalID","dropdownPortalID","modalPortalID","tabTooltipPortalID","rootID","createRootElement","id","rootContainer","addRootElement","rootElem","usePortal","rootElemRef","useRef","useEffect","rootEL","existingParent","parentElem","getRootElem","Portal","children","target","createPortal"],"mappings":"gFAAO,MAAMA,EAAe,cACfC,EAAiB,oBACjBC,EAAmB,8BACnBC,EAAgB,oBAChBC,EAAqB,0BCDrBC,EAASL,EAEtB,SAASM,EAAkBC,EAAY,CAC/B,MAAAC,EAAgB,SAAS,cAAc,KAAK,EACpC,OAAAA,EAAA,aAAa,KAAMD,CAAE,EACrBC,EAAA,aAAa,UAAWD,CAAE,EACjCC,CACT,CAEA,SAASC,EAAeC,EAAgB,CACtC,SAAS,KAAK,aACZA,EACA,SAAS,KAAK,iBAAkB,kBAAA,CAEpC,CAEA,SAASC,EAAUJ,EAAaF,EAAQ,CAChC,MAAAO,EAAcC,SAA8B,IAAI,EAEtDC,EAAA,UACE,UAAwB,CACtB,MAAMC,EAASH,EAAY,QAE3B,GADI,CAACG,GACD,CAACR,EAAI,OAEH,MAAAS,EACJ,SAAS,cAAc,IAAIT,GAAI,GAC/B,SAAS,cAAc,aAAaA,KAAM,EAEtCU,EAAaD,GAAkBV,EAAkBC,CAAE,EAGzD,OAAKS,GAAgBP,EAAeQ,CAAU,EAG9CA,EAAW,YAAYF,CAAM,EAEtB,UAAyB,CAC9BA,EAAO,OAAO,EACTE,EAAW,mBACdA,EAAW,OAAO,CACpB,CAEJ,EACA,CAACV,CAAE,CAAA,EAaL,SAASW,GAAc,CACjB,OAACN,EAAY,UACHA,EAAA,QAAU,SAAS,cAAc,KAAK,GAE7CA,EAAY,OACrB,CAEA,OAAOM,EAAY,CACrB,CC1DO,SAAAC,EAAA,CAAgB,GAAAZ,EAAAF,EAChB,SAAAe,CAEP,EAAA,CACE,MAAAC,EAAAV,EAAAJ,CAAA,EACA,OAAAe,EAAA,aAAAF,EAAAC,CAAA,CACF"}