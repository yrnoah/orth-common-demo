{"version":3,"file":"SearchBar.stories-4512f6ce.js","sources":["../../../paas-library/src/Input/SearchBar/SearchBar.tsx"],"sourcesContent":["import React, {\n  forwardRef,\n  memo,\n  useCallback,\n  useDeferredValue,\n  useMemo,\n  useRef,\n  useState,\n} from \"react\";\nimport { useUpdateEffect } from \"react-use\";\nimport styled from \"styled-components\";\nimport { IconClose, IconSearch } from \"../../icons\";\nimport { isKeyEnter } from \"../../utils/keyCode\";\n\ninterface SearchInputProps extends React.InputHTMLAttributes<HTMLInputElement> {\n  /**\n   * search layout style\n   */\n  style?: React.CSSProperties;\n  /**\n   * search input style\n   */\n  inputStyle?: React.CSSProperties;\n  /**\n   * @link https://react.dev/reference/react/useDeferredValue\n   * @description auto triggered by react useDeferredValue\n   */\n  onSearch?: (v: string) => void;\n  searchIconStyle?: React.CSSProperties;\n  clearIconStyle?: React.CSSProperties;\n}\n\nconst SearchInput = forwardRef<HTMLInputElement, SearchInputProps>(\n  (\n    {\n      style,\n      inputStyle,\n      disabled,\n      onChange,\n      onFocus,\n      onBlur,\n      onKeyUp,\n      onSearch,\n      onClick,\n      onMouseOver,\n      onMouseLeave,\n      searchIconStyle,\n      clearIconStyle,\n      ...rest\n    },\n    ref\n  ) => {\n    const inputRef = useRef<HTMLInputElement>();\n    const onRefCallback = useCallback(\n      (el: HTMLInputElement) => {\n        if (inputRef && el) inputRef.current = el;\n        if (ref && el) {\n          if (typeof ref === \"function\") {\n            ref(el);\n            return;\n          }\n          ref.current = el;\n        }\n      },\n      [inputRef, ref]\n    );\n    const [_input, setInput] = useState<string>(() => {\n      if (typeof rest.value === \"string\") return rest.value;\n      return `${rest.defaultValue || \"\"}`;\n    });\n    const deferredValue = useDeferredValue(_input);\n    const [_focused, setFocus] = useState<boolean>(false);\n    const [_hover, setHover] = useState<boolean>(false);\n\n    const _showClear = useMemo(() => {\n      if (!_input) return false;\n      if (disabled || rest.readOnly) return false;\n      if (_focused || _hover) return true;\n      return false;\n    }, [_focused, _input, _hover, disabled, rest.readOnly]);\n\n    const onClickSearch = useCallback(() => {\n      if (disabled) return;\n      if (onSearch) onSearch(_input);\n    }, [_input, disabled, onSearch]);\n    useUpdateEffect(() => {\n      onClickSearch();\n    }, [deferredValue]);\n\n    const _onChange = useCallback(\n      (event: React.ChangeEvent<HTMLInputElement>) => {\n        if (!event) return;\n        if (onChange) onChange(event);\n        const value = event.target.value || \"\";\n        setInput(value);\n      },\n      [onChange]\n    );\n\n    const onClear = useCallback(() => {\n      if (disabled) return;\n      const el = inputRef.current;\n      const event = new Event(\"onChange\", {\n        bubbles: true,\n      });\n      if (el) {\n        el.value = \"\";\n        el.dispatchEvent(event);\n        el.focus();\n      }\n      if (event.target)\n        _onChange(event as unknown as React.ChangeEvent<HTMLInputElement>);\n      setInput(\"\");\n    }, [_onChange, inputRef, disabled]);\n\n    const _onFocus = (event: React.FocusEvent<HTMLInputElement>) => {\n      if (onFocus) onFocus(event);\n      setFocus(true);\n    };\n\n    const _onBlur = (event: React.FocusEvent<HTMLInputElement>) => {\n      if (onBlur) onBlur(event);\n      setFocus(false);\n    };\n\n    const _onKeyUp = (event: React.KeyboardEvent<HTMLInputElement>) => {\n      if (disabled) return;\n      if (onKeyUp) onKeyUp(event);\n      if (isKeyEnter(event) && onSearch) {\n        onSearch(_input);\n      }\n    };\n    const _onMouseOver = (event: React.MouseEvent<HTMLInputElement>) => {\n      setHover(true);\n      onMouseOver && onMouseOver(event);\n    };\n    const _onMouseLeave = (event: React.MouseEvent<HTMLInputElement>) => {\n      setHover(false);\n      onMouseLeave && onMouseLeave(event);\n    };\n    return (\n      <SearchLayout\n        onMouseOver={_onMouseOver}\n        onMouseLeave={_onMouseLeave}\n        style={style}\n        onClick={onClick}\n      >\n        <Input\n          {...rest}\n          ref={onRefCallback}\n          style={inputStyle}\n          onChange={_onChange}\n          onFocus={_onFocus}\n          onBlur={_onBlur}\n          onKeyUp={_onKeyUp}\n          disabled={disabled}\n          $showClear={_showClear}\n        />\n        <SearchIcon />\n        {_showClear && !disabled && (\n          <ClearIcon style={clearIconStyle} onClick={onClear} />\n        )}\n      </SearchLayout>\n    );\n  }\n);\n\nexport default memo(SearchInput);\n\n/** @issues outline & border-radius https://github.com/google/model-viewer/issues/662#issuecomment-1451606074 */\nexport const SearchLayout = styled.div`\n  width: fit-content;\n  height: fit-content;\n  position: relative;\n`;\n\nconst SearchIcon = styled(IconSearch)`\n  width: 16px;\n  height: 16px;\n  flex-shrink: 0;\n  color: ${(p) => p.theme.colors.textInput.minor};\n  position: absolute;\n  top: 50%;\n  transform: translateY(-50%);\n  left: 16px;\n  pointer-events: none;\n`;\n\nconst ClearIcon = styled(IconClose)`\n  width: 16px;\n  height: 16px;\n  flex-shrink: 0;\n  color: ${(p) => p.theme.colors.noColor.Grey13};\n  position: absolute;\n  top: 50%;\n  transform: translateY(-50%);\n  right: 16px;\n`;\n\nexport const Input = styled.input<{ $showClear?: boolean }>`\n  width: 100%;\n  min-width: 110px;\n  height: 36px;\n  line-height: 36px;\n  flex-shrink: 0;\n  border-radius: ${(p) => p.theme.radius.xxl}px;\n  border: 1px solid ${(p) => p.theme.colors.button.default};\n  outline: none;\n  margin: 0;\n  padding: 0 ${(p) => (p.$showClear ? \"39px\" : \"15px\")} 0 39px;\n  gap: ${(p) => p.theme.padding.xxs}px;\n  ${(p) => p.theme.fonts[\"Body-Medium/Regular\"]}\n  color: ${(p) => p.theme.colors.textInput.default};\n  caret-color: ${(p) => p.theme.colors.textInput.link};\n  background: transparent;\n\n  &::placeholder {\n    color: ${(p) => p.theme.colors.textInput.minor};\n  }\n\n  &::selection {\n    background: ${(p) => p.theme.colors.brandColor.Primary2};\n  }\n\n  &:hover {\n    border: 1px solid ${(p) => p.theme.colors.button.hovered};\n\n    & + ${SearchIcon}, &::placeholder {\n      color: ${(p) => p.theme.colors.textInput.default};\n    }\n  }\n\n  &:focus {\n    border: 1px solid ${(p) => p.theme.colors.textInput.link};\n    background: ${(p) => p.theme.colors.button.default};\n\n    & + ${SearchIcon} {\n      color: ${(p) => p.theme.colors.textInput.default};\n    }\n\n    &::placeholder {\n      color: ${(p) => p.theme.colors.textInput.minor};\n    }\n  }\n`;\n"],"names":["SearchInput","forwardRef","style","inputStyle","disabled","onChange","onFocus","onBlur","onKeyUp","onSearch","onClick","onMouseOver","onMouseLeave","searchIconStyle","clearIconStyle","ref","inputRef","useRef","onRefCallback","useCallback","el","_input","setInput","useState","rest","deferredValue","useDeferredValue","_focused","setFocus","_hover","setHover","_showClear","useMemo","onClickSearch","useUpdateEffect","_onChange","event","value","onClear","_onFocus","_onBlur","_onKeyUp","isKeyEnter","_onMouseOver","_onMouseLeave","jsxs","SearchLayout","jsx","Input","SearchIcon","ClearIcon","SearchBar","memo","styled","IconSearch","p","IconClose","input","xxl","default","xxs","link","minor","Primary2","hovered"],"mappings":"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"}