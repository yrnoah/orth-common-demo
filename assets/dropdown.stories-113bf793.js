import{j as i}from"./jsx-runtime-94f6e698.js";import{r as t}from"./index-8db94870.js";import{p as I}from"./styled-components.browser.esm-655d472d.js";import{u as Y,P as K,a as Q}from"./useCurrent-9b1a0363.js";import{u as ee,a as te}from"./useEffectOnce-838fab99.js";import{u as ne}from"./useMeasure-361079ab.js";import{o as W,a as O,i as B}from"./util-051783c3.js";import"./_commonjsHelpers-042e6b4d.js";import"./index-8ce4a492.js";var re=function(e){var r=t.useRef(e);r.current=e,ee(function(){return function(){return r.current()}})};const oe=re;var se=function(e){var r=t.useRef(0),o=t.useState(e),a=o[0],n=o[1],c=t.useCallback(function(f){cancelAnimationFrame(r.current),r.current=requestAnimationFrame(function(){n(f)})},[]);return oe(function(){cancelAnimationFrame(r.current)}),[a,c]};const V=se,ie=function(){var e=t.useState(0),r=e[0],o=e[1];return t.useEffect(function(){var a=function(n){o(n.deltaY+r)};return W(window,"wheel",a,!1),function(){return O(window,"wheel",a)}}),r};var le=function(e){var r=V({x:0,y:0}),o=r[0],a=r[1];return t.useEffect(function(){var n=function(){e.current&&a({x:e.current.scrollLeft,y:e.current.scrollTop})};return e.current&&W(e.current,"scroll",n,{capture:!1,passive:!0}),function(){e.current&&O(e.current,"scroll",n)}},[e]),o};const ae=le;var ce=function(){var e=V(function(){return{x:B?window.pageXOffset:0,y:B?window.pageYOffset:0}}),r=e[0],o=e[1];return t.useEffect(function(){var a=function(){o(function(n){var c=window.pageXOffset,f=window.pageYOffset;return n.x!==c||n.y!==f?{x:c,y:f}:n})};return a(),W(window,"scroll",a,{capture:!1,passive:!0}),function(){O(window,"scroll",a)}},[]),r};const ue=ce;function fe(e=300,r=0,o=40,a=!1,n){const c=t.useRef(null),[f,b]=V(0),[p,u]=V(0),[l,m]=t.useState(120),[C,j]=t.useState(o),[v,g]=t.useState(()=>{switch(n){default:return!1;case"top":case"top-left":case"top-right":return!0}}),S=t.useCallback((s,h=300)=>{m(s.width),s.height&&j(s.height);const w=r||s.width,_=window.innerHeight-s.bottom,E=s.left+w-window.innerWidth>0&&w>0;let x=_<h;if((a||n==="bottom"||n==="bottom-left"||n==="bottom-right")&&(x=!1),(n==="top"||n==="top-left"||n==="top-right")&&(x=!0),s.top<h&&(x=!1),s.top!==f&&!x&&b((s.top||0)+C),x&&f!==s.top-h&&b(s.top-h),n==="bottom-right"||n==="top-right"){u(s.left-w+s.width);return}if(n==="bottom"||n==="top"){u(s.left-(w-s.width)*.5);return}if(n==="bottom-left"||n==="top-left"){u(s.left||0);return}g(x),E||u(s.left||0),E&&u(s.left-w+s.width)},[r,a,n,f,b,C,u]),R=t.useCallback(()=>{const s=c.current;s&&s.getBoundingClientRect&&S(s.getBoundingClientRect(),e)},[e,c,S]),y=Y(R);return t.useEffect(()=>{y.current()},[y,e,c]),{onHoverUpdateRect:R,updateRect:S,top:Math.max(f,0),isTop:v,left:p,width:l,height:C,ref:c}}function de(e){if(Array.isArray(e))return!1;switch(typeof e){default:return!1;case"string":case"number":case"bigint":case"boolean":case"undefined":return!1;case"object":case"function":case"symbol":return t.isValidElement(e)}}function k(e){const{overlayContainerStyle:r,visible:o,onVisibleChange:a,disableAnimation:n,disableAutoDismiss:c,parentNodeID:f=Q,scrollRef:b,triggerType:p="click"}=e,u=t.useRef(!1),[l,{height:m,width:C}]=ne(),j=Y(a),[v,g]=t.useState(!!o);t.useEffect(()=>{g(d=>d!==o?!!o:d)},[o]),t.useEffect(()=>{j.current&&j.current(v)},[v,j]);const S=!!m&&!!C,{ref:R,top:y,left:s,onHoverUpdateRect:h,isTop:w}=fe(m,C,32,!1,e.position);te(R,()=>{c||u.current||g(!1)});const _=ie();t.useEffect(()=>{if(c){h();return}u.current||g(!1)},[_,c,h]);const{x:E,y:x}=ue(),X=t.useRef(null),{x:H,y:Z}=ae(b||X);t.useEffect(()=>{if(c){h();return}u.current||g(!1)},[c,h,E,x,H,Z]);const G=t.useMemo(()=>{const d=S&&v?1:0,J=S&&v?"auto":"none";let q=v?y:y*.9;return w&&(q=v?y:y*1.1),n&&(q=y),{transition:n?"none":void 0,pointerEvents:J,opacity:d,...r||{},zIndex:v?r==null?void 0:r.zIndex:-1,top:q,left:s}},[S,v,y,w,n,r,s]),A=t.useCallback(()=>{u.current=!0,p==="hover"&&g(!0),h()},[h,p]),T=de(e.children);return i.jsxs(i.Fragment,{children:[T&&t.cloneElement(e.children,{ref:d=>{"ref"in e.children&&typeof e.children.ref=="function"&&e.children.ref(d),"ref"in e.children&&typeof e.children.ref=="object"&&e.children.ref&&"current"in e.children.ref&&(e.children.ref.current=d),R.current=d},onMouseEnter:d=>{e.children.props.onMouseEnter&&e.children.props.onMouseEnter(d),A()},onMouseLeave:d=>{e.children.props.onMouseLeave&&e.children.props.onMouseLeave(d),u.current=!1,p==="hover"&&g(!1)}}),!T&&i.jsx(pe,{ref:R,style:e.style,onMouseEnter:A,onMouseLeave:()=>{u.current=!1,p==="hover"&&g(!1)},role:"select",children:e.children}),!!e.overlay&&i.jsx(K,{id:f,children:i.jsx(he,{style:G,ref:d=>d&&l(d),onMouseEnter:A,onMouseLeave:()=>{u.current=!1,p==="hover"&&g(!1)},children:e.overlay})})]})}const pe=I.div`
  position: relative;
  display: flex;
  flex: none;
  width: max-content;
  align-items: center;
  box-sizing: border-box;
`,he=I.div`
  position: fixed;
  z-index: ${e=>e.theme.zIndexes.dropdownZIndex};
  width: max-content;
  box-sizing: border-box;
  max-height: 80vh;
  transition: top 0.2s ease, opacity 0.2s ease;
`;try{k.displayName="BaseDropdown",k.__docgenInfo={description:"",displayName:"BaseDropdown",props:{children:{defaultValue:null,description:"trigger component",name:"children",required:!1,type:{name:"ReactNode"}},triggerType:{defaultValue:{value:'"click"'},description:"",name:"triggerType",required:!1,type:{name:"enum",value:[{value:'"click"'},{value:'"hover"'}]}},overlay:{defaultValue:null,description:"dropdown component",name:"overlay",required:!1,type:{name:"ReactNode"}},style:{defaultValue:null,description:"trigger wrapper styles",name:"style",required:!1,type:{name:"CSSProperties"}},overlayContainerStyle:{defaultValue:null,description:"dropdown wrapper styles",name:"overlayContainerStyle",required:!1,type:{name:"CSSProperties"}},position:{defaultValue:{value:`undefined = auto
dropdown position: "top-left" | "top-right" | "bottom-left" | "bottom-right" | "top" | "bottom" | undefined = auto`},description:"",name:"position",required:!1,type:{name:"enum",value:[{value:'"auto"'},{value:'"bottom"'},{value:'"top"'},{value:'"top-left"'},{value:'"top-right"'},{value:'"bottom-left"'},{value:'"bottom-right"'}]}},visible:{defaultValue:null,description:"dropdown visible",name:"visible",required:!1,type:{name:"boolean"}},onVisibleChange:{defaultValue:null,description:"dropdown visible onChange callback",name:"onVisibleChange",required:!1,type:{name:"((visible: boolean) => void)"}},disableAutoDismiss:{defaultValue:null,description:"disable the auto dismiss when user click or scroll outside",name:"disableAutoDismiss",required:!1,type:{name:"boolean"}},disableAnimation:{defaultValue:null,description:"disable dropdown enter & leave default animation",name:"disableAnimation",required:!1,type:{name:"boolean"}},parentNodeID:{defaultValue:{value:"dropdownPortalID (`orthogonal-dropdown-overlay`)"},description:"ID of the dom element, which will be insert the dropdown items",name:"parentNodeID",required:!1,type:{name:"string"}},scrollRef:{defaultValue:null,description:"the scroll element ref, add listener to watch scroll event",name:"scrollRef",required:!1,type:{name:"RefObject<HTMLElement>"}}}}}catch{}const ke={title:"PAAS/Dropdown",tags:["autodocs"],component:k,argTypes:{children:{table:{disable:!0}}}};function me({...e}){const[r,o]=t.useState(!1),a=t.useRef(null),[n,c]=t.useState(3),f=t.useMemo(()=>i.jsx(i.Fragment,{children:Array.from({length:n}).map((l,m)=>i.jsxs(U,{children:["item ",m+1]},m))}),[n]),b=t.useCallback(()=>{c(l=>l+1),o(!1)},[]),p=t.useCallback(()=>{c(l=>Math.max(l-1,0)),o(!1)},[]),u=t.useCallback(l=>o(!!l),[]);return i.jsxs("div",{style:{width:"80vw",height:"80vh",overflow:"scroll"},ref:a,children:[i.jsxs("div",{style:{position:"absolute",top:0,right:0},children:[i.jsx("button",{onClick:b,style:{marginRight:8},children:"increase option"}),i.jsx("button",{onClick:p,children:"decrease option"})]}),i.jsx(k,{...e,visible:r,scrollRef:a,overlay:f,onVisibleChange:u,children:i.jsx("button",{onClick:()=>o(l=>!l),style:{margin:"50vh 60vw"},children:"trigger"})})]})}function ve({...e}){const[r,o]=t.useState(!1),a=t.useRef(null),[n,c]=t.useState(3),f=t.useMemo(()=>i.jsx(i.Fragment,{children:Array.from({length:n}).map((l,m)=>i.jsxs(U,{children:["item ",m+1]},m))}),[n]),b=t.useCallback(()=>{c(l=>l+1),o(!1)},[]),p=t.useCallback(()=>{c(l=>Math.max(l-1,0)),o(!1)},[]),u=t.useCallback(l=>o(!!l),[]);return i.jsxs("div",{style:{width:"80vw",height:"80vh",overflow:"scroll"},ref:a,children:[i.jsxs("div",{style:{position:"absolute",top:0,right:0},children:[i.jsx("button",{onClick:b,style:{marginRight:8},children:"increase option"}),i.jsx("button",{onClick:p,children:"decrease option"})]}),i.jsxs(k,{...e,visible:r,scrollRef:a,overlay:f,onVisibleChange:u,children:[i.jsx("button",{onClick:()=>o(l=>!l),children:"trigger"}),i.jsx("button",{onClick:()=>o(l=>!l),children:"trigger"})]})]})}const U=I.div`
  height: 32px;
  width: 200px;
  display: flex;
  align-items: center;
  cursor: pointer;
  border-bottom: 1px solid grey;
`,M={render:me,args:{position:"auto",overlayContainerStyle:{outline:"1px solid red"}}},D={render:ve,args:{style:{margin:"50vh 60vw"},position:"auto",overlayContainerStyle:{outline:"1px solid red"}}};var P,L,F;M.parameters={...M.parameters,docs:{...(P=M.parameters)==null?void 0:P.docs,source:{originalSource:`{
  render: DropdownStory,
  args: {
    position: "auto",
    overlayContainerStyle: {
      outline: "1px solid red"
    }
  }
}`,...(F=(L=M.parameters)==null?void 0:L.docs)==null?void 0:F.source}}};var N,z,$;D.parameters={...D.parameters,docs:{...(N=D.parameters)==null?void 0:N.docs,source:{originalSource:`{
  render: BaseDropdownStory,
  args: {
    style: {
      margin: "50vh 60vw"
    },
    position: "auto",
    overlayContainerStyle: {
      outline: "1px solid red"
    }
  }
}`,...($=(z=D.parameters)==null?void 0:z.docs)==null?void 0:$.source}}};const Ee=["BaseDropdown","DropdownWithMultipleChildren"];export{M as BaseDropdown,D as DropdownWithMultipleChildren,Ee as __namedExportsOrder,ke as default};
//# sourceMappingURL=dropdown.stories-113bf793.js.map
